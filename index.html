<!DOCTYPE html>
<html lang="en">
    <head>

    </head>
    <body onload=init()>

        <canvas id="canvas"></canvas>
        

        <script>

            let screen_width = window.innerWidth
            let screen_height = window.innerHeight

            let x_min = -1.5
            let y_min = -2
            let x_max = 1.5
            let y_max = 2

            max_iterations = 80

            var canvas = document.getElementById('canvas')
            var ctx = canvas.getContext('2d')

            ctx.canvas.width = screen_width
            ctx.canvas.height = screen_height
            
            let imgdata = ctx.getImageData(0,0,screen_width, screen_height)
            let imgdatalength = imgdata.data.length

            function init() {
                let arr = []

                for (let i = 0; i <= screen_width; i++) {
                    for (let j = 0; j <= screen_height; j++){
                        c = {
                            x: mapPixel(i, x_min, x_max, screen_width),
                            y: mapPixel(j, y_min, y_max, screen_height)
                        }
                        let n = mandelbrot(c)

                        imgdata.data[4*i*(j+1)] = (51 + n) % 255 
                        imgdata.data[4*i*(j+1) + 1] = (102 + n) % 255 
                        imgdata.data[4*i*(j+1) + 2] = (153 + n) % 255 
                        imgdata.data[4*i*(j+1) + 3] = (204 + n) % 255 

                        console.log(4*i*(j+1))

                    }
                }
                ctx.putImageData(imgdata, 0, 0)
                console.log(arr)
                
            }

            function mandelbrot(c) {
                let z = { x: 0, y: 0 }, n = 0, div=0;

                while (n < max_iterations && div <= 2){
                
                let z_squared = {
                    x: Math.pow(z.x, 2) - Math.pow(z.y, 2),
                    y: 2 * z.x * z.y
                    }                

                z = {
                    x: z_squared.x + c.x,
                    y: z_squared.y + c.y
                }

                div = Math.sqrt(Math.pow(z.x, 2) + Math.pow(z.y, 2));
                n += 1;
                }
                return n
            }

            function mapPixel(pixel, min, max, screen) {
                return (max - min) / screen * pixel
            }

            

            function draw() {

            }

        </script>
    </body>
</html>